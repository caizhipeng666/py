# 装饰器

> 装饰器在被装饰的函数定义之后立即运行(导入模块)

内容|description
---|---
[变量作用域](#变量作用域)|
[单分派泛函数](#单分派泛函数)|singledispatch
[缓存函数](#缓存函数)|functools.lru_cache

### 变量作用域
```python
b = 1


def test(a):
    print(a)
    print(b)
    b = 2

test(1)

>>> UnboundLocalError: local variable 'b' referenced before assignment

> 使用dis.dis(test)会发现b变量是load_fast而不是global
```

> 先判断了b是局部变量, 当Python从本地环境尝试获取b时, 发现b没有绑定值

### 单分派泛函数
```python
from functools import singledispatch


class A: ...


@singledispatch
def test(obj):
    print(type(obj))


@test.register(A)
def test_2(x):
    print("register A")


test("a")
test(A())

>>> <class 'str'>
    register A
```

### 缓存函数
```python
@functools.lru_cache(maxsize=None, typed=False)
```